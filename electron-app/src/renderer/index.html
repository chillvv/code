<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>简知订单整理发送器（Electron）</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <h1>简知订单整理发送器</h1>
    <div class="drop" id="drop">将 Excel/CSV 拖拽到此处，或点击“选择文件”</div>
    <div class="row">
      <button id="pick">选择文件</button>
      <span id="fileName">未选择文件</span>
    </div>
    <div class="grid">
      <label>商品信息
        <select id="colProduct"></select>
      </label>
      <label>支付状态
        <select id="colPay"></select>
      </label>
      <label>订单状态
        <select id="colStatus"></select>
      </label>
      <label>收货地址
        <select id="colAddr"></select>
      </label>
      <label>用户备注
        <select id="colNote"></select>
      </label>
    </div>
    <div class="grid">
      <label>午餐起始编号
        <input type="number" id="startLunch" value="7" min="1" />
      </label>
      <label>晚餐起始编号
        <input type="number" id="startDinner" value="7" min="1" />
      </label>
      <label>午餐发送至
        <input list="groups" id="groupLunch" value="简知午餐群" />
      </label>
      <label>晚餐发送至
        <input list="groups" id="groupDinner" value="简知晚餐群" />
      </label>
      <datalist id="groups">
        <option value="简知午餐群"></option>
        <option value="简知晚餐群"></option>
        <option value="末"></option>
      </datalist>
    </div>
    <div class="grid">
      <label>发送间隔(秒) 最小
        <input type="number" step="0.1" id="intMin" value="1.0" min="0.1" />
      </label>
      <label>发送间隔(秒) 最大
        <input type="number" step="0.1" id="intMax" value="1.5" min="0.1" />
      </label>
      <label>
        <input type="checkbox" id="testMode" /> 测试模式（发送到“末”）
      </label>
      <label>模式
        <select id="mode">
          <option value="wechat">wechat(推荐)</option>
        </select>
      </label>
      <div></div>
    </div>

    <div class="row">
      <button id="btnConnect">连接</button>
      <button id="btnDisconnect" disabled>断开</button>
      <button id="btnPreview">预览</button>
      <button id="btnSend">发送</button>
      <button id="btnStop">停止（Ctrl+Shift+S）</button>
    </div>

    <div class="split">
      <textarea id="preview" placeholder="预览区"></textarea>
      <div class="status">
        <div id="status">就绪</div>
        <img id="qr" alt="登录二维码" />
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="renderer.js"></script>
  </body>
  </html>

