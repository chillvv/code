## 简知订单整理发送器（wxauto）

基于 PyQt5、pandas、wxauto 的桌面工具：
- 拖拽任意 Excel/CSV 文件
- 自动按规则筛选、倒序、编号、格式化
- 一键预览；测试模式发送到“末”；正式发送到指定群（午餐/晚餐）
- 发送间隔可调（默认 1.0–1.5s），支持快捷键停止（Ctrl+Shift+S）

注意：wxauto 仅支持 Windows 且需要已登录的 PC 微信。

### 快速开始（Windows）

1. 双击 `start_app.bat` 自动创建虚拟环境、安装依赖并启动。
2. 将 Excel/CSV 拖到界面；或点击“选择文件…”。
3. 若字段名不同，使用“字段映射”下拉框对应到：`商品信息/支付状态/订单状态/收货地址/用户备注`。
4. 设置午餐/晚餐起始编号、目标群聊（默认：`简知午餐群` 和 `简知晚餐群`）。
5. 点击“预览”核对格式；勾选“测试模式”即可改为发送到 `末` 群。
6. 点击“发送”，间隔随机 1.0–1.5s；按 `Ctrl+Shift+S` 或点“停止”按钮可中断。

### Excel 规则说明（内置实现）

- 仅保留 `支付状态=已支付` 的订单；排除 `未支付/已取消/用户申请退款/已退款`。
- 分类：`商品信息=明日午餐 x1` 为午餐；`商品信息=明日晚餐 x1` 为晚餐。
- 倒序：按原始物理行号自下而上；与时间无关。
- 编号：午餐、晚餐各自独立，从设置的起始数连续递增。
- 地址拆分：输出为 `姓名 - 电话 - 详细地址`，保留原始符号；若无法严格三段拆分，尽力解析手机号，否则保留为 ` -  - 原始文本`。
- 用户备注：若有，单独一行显示为 `（用户备注：xxx）`。
- 输出分两段，标题分别为“午餐/晚餐”，示例见预览区。

### 常见问题

- 发送不起作用？请在 Windows 上运行，并确认 `wxauto` 与 `pywin32` 已安装、PC 微信已登录。
- 中文乱码？脚本已设置 UTF-8；如仍异常，请确保终端字体支持中文。
- xls 无法读取？`xlrd==1.2.0` 已包含；若依旧失败，请先另存为 `xlsx`。

### 开发

```bash
python -m venv .venv
. .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
python -m wx_order_sender.main
```

